[{"title":"使用Py3Dmol创建分子轨迹","path":"/2024/07/19/py3dmol/","content":"Py3Dmol实现分子轨迹的创建本文为使用py3Dmol库创建一系列分子坐标（多帧）组成的分子轨迹，进行动态可视化的教程。 3Dmol.js3Dmol.js 是一个用于科学可视化的开源 JavaScript 库，特别是用于显示和操纵生物分子结构。支持多种文件格式，如 PDB（Protein Data Bank）文件、SDF（Structure-Data File）文件等，用于加载分子数据。利用 WebGL 技术，3Dmol.js 能够高效地渲染大型分子结构，提供流畅的用户体验。因此被广泛应用于生物信息学、药物设计和分子生物学等领域，用于研究和展示分子的三维结构和相互作用。 py3Dmol简单来说，py3Dmol 可以被视为 3Dmol.js 的 Python API。py3Dmol 是一个 Python 库，它提供了与 3Dmol.js 交互的接口，使得用户可以在 Python 环境中使用 3Dmol.js 的功能。py3Dmol 为需要在 Python 环境中进行分子可视化的用户提供了便利，使得 3Dmol.js 的强大功能可以更方便地应用于科学研究和数据分析。 有人可能会问为什么不直接使用 GUI 界面的软件，或者 ase 库中的 view 等，本教程主要是针对 Linux 中没有 GUI 的情况下对分子的快捷可视化。 对于分子的可视化，py3Dmol 是非常实用的，但 py3Dmol 中实现的接口功能并不多，并且没有文档支持，以至于我花费很长时间读 py3Dmol 的源码才搞清楚如何使用其进行分子轨迹的可视化ToT，为了防止大家踩坑所以出一个教程。 py3Dmol安装如果你还没有安装 py3Dmol（可能是废话，不然你也不会点进来），可以方便地直接通过 pip 安装。 1pip install py3Dmol 以及安装可能用到的 pymatgen 库。 1pip install pymatgen 可视化单个分子构象（示例）很简单的例子，如果你还没有用过 py3Dmol ，可以在 jupyter 中试一下。 1234567891011121314import py3Dmoldef draw_mol_xyz(file_path): # 读取一个 .xyz 文件进行可视化 with open(file_path, &#x27;r&#x27;) as fo: xyz = fo.read() view = py3Dmol.view(width=800, height=400) view.addModel(xyz, &#x27;xyz&#x27;) view.setStyle(&#123;&#x27;sphere&#x27;: &#123;&#x27;scale&#x27;: 0.35&#125;, &#x27;stick&#x27;: &#123;&#x27;radius&#x27;: 0.20&#125;&#125;) view.zoomTo() view.show()file_path = &#x27;.xyz&#x27; # 你的 .xyz 文件路径draw_mol_xyz(file_path) 运行结果如下： 可视化分子轨迹这里以生成苯环的多帧坐标轨迹为例。 首先读取分子的原子序数和坐标123456import py3Dmolfrom pymatgen.core.structure import Moleculecoords = [] # 坐标# 使用 pymatgen 创建 Molecule对象以便于 .xyz 格式转换，此处我有100帧坐标因此创建100个对象。benzenes = [Molecule([&quot;C&quot;]*6 + [&#x27;H&#x27;]*6, coords[i]) for i in range(100)] coords: 轨迹坐标，维度为[frames, N, 3]，frames为帧数。 benzenes: Molecule对象列表，[frames, ] 格式转换以及可视化123456789101112molecules = [mol.to(fmt=&quot;xyz&quot;) for mol in benzenes[-50:]] + [benzenes[-1].to(fmt=&quot;xyz&quot;)] * 20 # 最后一帧停顿models = &#x27;&#x27;view = py3Dmol.view(width=800, height=400)for i, mol in enumerate(molecules): models += mol + &#x27; &#x27;view.addModelsAsFrames(models) # 添加多帧 xyz 字符串view.setStyle(&#123;&#x27;sphere&#x27;: &#123;&#x27;scale&#x27;: 0.35&#125;, &#x27;stick&#x27;: &#123;&#x27;radius&#x27;: 0.20&#125;&#125;)view.zoomTo()view.animate(&#123;&#x27;loop&#x27;: &#x27;forward&#x27;&#125;) # animateview.show() 运行结果如下：","tags":["Py3Dmol","可视化","code"],"categories":["理论计算"]},{"title":"Hexo Guidance","path":"/2024/03/27/hello/","content":"How to use hexo to create a blog? hexo new ‘name_of_blog’ modify the .&#x2F;source&#x2F;_posts&#x2F;name_of_blog.md hexo clean hexo g hexo d","tags":["hexo"],"categories":["Code"]}]